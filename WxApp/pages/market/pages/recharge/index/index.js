"use strict";var common=getApp().globalData.commonFun,util=getApp().globalData.utilFun;Page({data:{interfaceName:"rechargeIndex",contactStatus:!0,cash_balance:0,list:[],requestStatus:!1},state:{limit:10,offset:0,hasmore:!0,isOnReachBottom:!1,isonPullDownRefresh:!1},store:function(t){this.setData(t)},onLoad:function(){var t=this;common.getAccessToken()?(t.getData(0),common.commonFun(t),common.getWallet(t)):getApp().globalData.tokenUpdated=function(){console.log("update success"),t.getData(0),common.commonFun(t),common.getWallet(t)}},onShow:function(){var t=this;getApp().globalData.updateCashcard=function(){t.state.offset=0,t.onLoad()}},getData:function(t){var a=this,e="/wallet/transaction/?offset="+t+"&limit="+this.state.limit+"&type=cashcard";util.httpRequest(e).then(function(e){var o=common.dataListHandle(a,e,a.data.list,t);a.store({list:o.list,requestStatus:!0,hasNext:o.hasNext})})},chongzhi:function(){if(!this.data.iphoneShow)return void common.showClickModal("当前小程序暂不支持该功能");wx.navigateTo({url:"/pages/market/pages/recharge/balanceRecharge/balanceRecharge"})},onReachBottom:function(){this.state.isonPullDownRefresh||this.state.isOnReachBottom&&this.state.hasmore&&(wx.showLoading({title:"加载中...",mask:!0}),this.state.offset=this.state.offset+this.state.limit,this.getData(this.state.offset),this.state.isOnReachBottom=!1)}});