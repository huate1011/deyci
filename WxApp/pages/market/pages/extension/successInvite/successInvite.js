"use strict";var common=getApp().globalData.commonFun,util=getApp().globalData.utilFun,extensionCenterTemp=require("../../../../commonPage/extension/comfunc.js");Page({data:{interfaceName:"successInvite",contactStatus:!0,requestStatus:!1,logoPosBottom:!0,list:[],InviteCount:0,Invitemoney:0,oldId:0},state:{limit:10,offset:0,hasmore:!0},onLoad:function(t){wx.showLoading({title:"加载中...",mask:!0}),this.state.options=t,common.commonFun(this),t.hasOwnProperty("type")?(this.getHistory(0),wx.setNavigationBarTitle({title:"历史申请记录"})):(this.getInviteList(0),wx.setNavigationBarTitle({title:"成功邀请"}))},getInviteList:function(t){var s=this,e=this,i=this.state.options,o="/sales/salesman/?acid="+getApp().globalData.acid+"&offset="+t+"&limit="+this.state.limit,a=0,n=0;i.hasOwnProperty("id")&&(o+="&ids="+i.id,a=i.id,n=2),util.httpRequest(o).then(function(i){var o=common.dataListHandle(e,i,e.data.list,t);e.setData({list:o.list,InviteCount:i.count,requestStatus:!0,hasNext:o.hasNext,types:n,oldId:a}),extensionCenterTemp.tuiguangInfo(s,"")})},getHistory:function(t){var s=this,e="/api/ProToClient/history?offset="+t+"&limit="+this.state.limit,i=this;util.httpRequest(e,{},"GET","v2").then(function(e){var o=common.dataListHandle(i,e,i.data.list,t);i.setData({list:o.list,InviteCount:e.count,hasNext:o.hasNext,types:1}),extensionCenterTemp.tuiguangInfo(s)})},onPullDownRefresh:function(){wx.showLoading({title:"加载中...",mask:!0}),this.state.offset=0,this.state.options.hasOwnProperty("type")?this.getHistory(0):this.getInviteList(0)},onReachBottom:function(){if(this.state.hasmore){wx.showLoading({title:"加载中...",mask:!0}),this.state.offset=this.state.offset+this.state.limit;this.state.options.hasOwnProperty("type")?this.getHistory(this.state.offset):this.getInviteList(this.state.offset)}}});