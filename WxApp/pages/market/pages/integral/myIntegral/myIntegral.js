"use strict";var common=getApp().globalData.commonFun,util=getApp().globalData.utilFun;Page({data:{interfaceName:"myIntegral",contactStatus:!0,requestStatus:!1,list:[]},state:{hasmore:!0,limit:10,offset:0,isOnReachBottom:!0},onLoad:function(t){wx.showLoading({title:"加载中...",mask:!0});var e=this;common.getAccessToken()?common.getWallet(e):getApp().globalData.tokenUpdated=function(){console.log("update success"),common.getWallet(e)},this.getInteRecord(this.state.offset)},getInteRecord:function(t){var e="/point/record/?offset="+this.state.offset+"&limit="+this.state.limit,s=this;util.httpRequest(e).then(function(e){var o=common.dataListHandle(s,e,s.data.list,t);s.setData({list:o.list,requestStatus:!0,hasNext:o.hasNext}),wx.hideLoading()})},onShow:function(){common.commonFun(this)},onReachBottom:function(){this.state.hasmore&&this.state.isOnReachBottom&&(wx.showLoading({title:"加载中...",mask:!0}),this.state.offset=this.state.offset+this.state.limit,this.getInteRecord(this.state.offset),this.state.isOnReachBottom=!1)}});