"use strict";var common=getApp().globalData.commonFun,util=getApp().globalData.utilFun;Page({data:{interfaceName:"integralShop",list:[],requestStatus:!1,logoPosBottom:!0},state:{hasmore:!0,offset:0,limit:10,pageOnShow:!1,isOnReachBottom:!0,isonPullDownRefresh:!1},onLoad:function(t){wx.showLoading({title:"加载中...",mask:!0});var o=this,a=common.getAccessToken();common.configData("integralShop",function(t){o.setData({config:t}),a?(common.commonFun(o),common.getWallet(o),o.getData(0)):getApp().globalData.tokenUpdated=function(){console.log("update success"),common.commonFun(o),common.getWallet(o),o.getData(0)}})},getData:function(t){var o="/point/"+getApp().globalData.acid+"/shop/?limit="+this.state.limit+"&offset="+t,a=this;util.httpRequest(o).then(function(o){var e=common.dataListHandle(a,o,a.data.list,t);a.store({list:e.list,requestStatus:!0,hasNext:e.hasNext}),wx.hideLoading()})},store:function(t){this.setData(t)},onShow:function(){this.state.pageOnShow&&common.commonFun(this)},onReachBottom:function(){this.state.isOnReachBottom&&this.state.hasmore&&(this.state.offset=this.state.offset+this.state.limit,this.getData(this.state.offset),this.state.isOnReachBottom=!1)},onShareAppMessage:function(t){return{path:"pages/market/pages/integral/integralShop/integralShop",success:function(t){},fail:function(t){}}}});