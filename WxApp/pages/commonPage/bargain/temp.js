"use strict";function getCountDown(t,e){e.state.time=setInterval(function(){t.forEach(function(t,a){if(1===Number(t.goodsStatus)||2==Number(t.goodsStatus)){var o="";1===Number(t.goodsStatus)&&(o=common.timeCountDown(e,t.endTime,"")),2===Number(t.goodsStatus)&&(o=common.timeCountDown(e,t.startTime,""));var n=t.startTime,s=util.formatTimeStamp(n),i=Date.parse(new Date),u=0;1===Number(t.goodsStatus)&&(u=s-i),2===Number(t.goodsStatus)&&(u=i-s),Number(u)>0?t.goodsStatus=3:Number(o.hour)<=0&&Number(o.minute)<=0&&Number(o.second)<=0?t.goodsStatus=3:(t.day=o.day,t.hour=o.hour,t.minute=o.minute,t.second=o.second)}}),e.setData({cutDownList:t})},1e3)}function getIndexList(t,e){clearInterval(t.state.time);var a="/api/BargainGoods/get?offset="+e+"&limit="+t.state.limit,o=t.state.typeId;o&&o>0&&(a+="&cateId="+o);var n=[];util.httpRequest(a,{},"GET","v2").then(function(a){if("success"===a.result){var o=common.dataListHandle(t,a,t.data.list,e);o.list.forEach(function(t){n.push({endTime:t.endTime,startTime:t.startTime,goodsStatus:t.goodsStatus})}),t.store({list:o.list,requestStatus:!0,hasNext:o.hasNext}),getCountDown(n,t)}wx.hideLoading()})}function getDetail(t,e){var a=t.data.list;if(a[e]){var o="/api/BargainGoods/get?id="+a[e].id;util.httpRequest(o,{},"GET","v2").then(function(o){"success"===o.result&&(a[e].showType=o.results.showType,a[e].goodsStatus=o.results.goodsStatus,a[e].header=o.results.header,a[e].joinPeople=o.results.joinPeople,t.setData({list:a}))})}}function getIndexNav(t){util.httpRequest("/api/BargainCommon/getCate",{},"GET","v2").then(function(e){var a=e.results,o=[],n=[];a.forEach(function(t,e){n.push(t),8!==n.length&&e!==a.length-1||(o.push(n),n=[])}),t.setData({navList:o})})}function bargainConfig(t){util.httpRequest("/api/BargainCommon/getConfig",{},"GET","v2").then(function(e){"success"===e.result?t(e.results):common.showClickModal(e.msg)})}function getIndexData(t){dataTemp.getBanner(t,"bargain"),getIndexList(t,0),getIndexNav(t),bargainConfig(),common.commonFun(t)}var util=getApp().globalData.utilFun,common=getApp().globalData.commonFun,dataTemp=getApp().globalData.dataTempFun;module.exports={getIndexData:getIndexData,getIndexList:getIndexList,bargainConfig:bargainConfig,getDetail:getDetail};