"use strict";var common=getApp().globalData.commonFun,util=getApp().globalData.utilFun;Page({data:{imgList:[]},state:{},onLoad:function(){var t=common.getStorage("userInfo");this.store({userInfo:t})},store:function(t){this.setData(t)},uploadImg:function(){var t=this,a=[];common.uploadImg("hongbao",1,function(o,e){e.forEach(function(t){a.push(t)}),t.state.imgurl=o,t.setData({imgList:a})})},submitBtn:function(t){if("back"===t.currentTarget.dataset.types)return void wx.navigateBack({delta:1});var a=this.state.imgurl;if(!a)return void common.showTimeToast("请上传收款码");var o={wx_paycode:{oss_object:JSON.parse(a[0].data).url}};wx.showLoading({title:"提交中...",mask:!0});util.httpRequest("/user/me/",o,"POST").then(function(t){wx.hideLoading(),"success"===t.result?wx.showModal({title:"提示",content:"提交成功！",showCancel:!1,success:function(){wx.navigateBack({delta:1})}}):wx.showClickModal(t.msg)})}});