"use strict";var common=getApp().globalData.commonFun;Page({data:{currentTab:0,contactStatus:!0,interfaceName:"selectCoupon",couponData:[],actCoupon:""},state:{offset:0,hasmore:!0},onLoad:function(t){this.state.selectedCoupon=getApp().globalData.couponCallback||!1,this.state.applicableCoupon=common.getStorage("applicableCoupon"),this.state.notApplicable=common.getStorage("notApplicable");var o=common.getStorage("applicableCoupon")||[];o.forEach(function(t){t.iconType="circle",t.using&&(t.iconType="success")}),common.commonFun(this),this.store({couponData:o})},swichNav:function(t){var o=this,e=parseInt(t.currentTarget.dataset.current);if(this.data.currentTab!==e){this.state.offset=0,this.state.hasmore=!0;var a=[];0===e?(a=this.state.applicableCoupon,a.forEach(function(t){t.iconType="circle",o.state.selectedCoupon&&t.id===o.state.selectedCoupon.id&&(t.iconType="success")})):a=this.state.notApplicable,this.setData({couponData:a,currentTab:e})}},selectConpon:function(t){var o=this.data.couponData,e=t.currentTarget.dataset.index;"success"===o[e].iconType?(o[e].iconType="circle",this.state.selectedCoupon={id:-1}):(o.forEach(function(t,e){o[e].iconType="circle"}),o[e].iconType="success",this.state.selectedCoupon=o[e]),this.store({couponData:o})},sureCoupon:function(){var t=this.state.selectedCoupon,o=getApp().globalData.couponCallback;o&&o(t),wx.navigateBack({delta:1})},toMakeSingle:function(t){var o=this.data.couponData,e=t.currentTarget.dataset.index,a=o[e],c=a.applicable_condition.categorie_ids,s=a.applicable_condition.product_ids;common.isNull(c)?common.isNull(s)?common.isNull(c)&&common.isNull(s)&&wx.redirectTo({url:"/pages/mall/pages/shopList/shopList"}):wx.redirectTo({url:"/pages/mall/pages/shopDetail/shopDetail?productId="+s}):wx.redirectTo({url:"/pages/mall/pages/shopList/shopList?categoryid="+c})},store:function(t){this.setData(t)}});