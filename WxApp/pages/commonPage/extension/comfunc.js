"use strict";function getInvite(t){var a="/sales/card/?acid="+getApp().globalData.acid+"&product_id="+t.state.productId;util.httpRequest(a).then(function(a){t.setData({haiBaoList:a}),wx.hideLoading()})}function tgShare(t){var a=t.state.mainLink,e=a.split("_"),i=t.data.myInfo.id,n="";switch(e[0]){case"hd":n="/pages/activity/pages/activityDetail/activityDetail?isODOpen=0&id="+e[1]+"&uid="+i;break;case"col":n="/pages/zhuanlan/pages/zhuanlanDetail/zhuanlanDetail?zhuanlanId="+e[1]+"&uid="+i;break;case"tw":n="/pages/zhuanlan/pages/danpinTuwenDetail/danpinTuwenDetail?danpinId="+e[1]+"&uid="+i;break;case"sp":n="/pages/zhuanlan/pages/danpinVideoDetail/danpinVideoDetail?danpinId="+e[1]+"&uid="+i;break;case"yp":n="/pages/zhuanlan/pages/danpinAudeoDetail/danpinAudeoDetail?danpinId="+e[1]+"&uid="+i;break;case"shop":n="/pages/mall/pages/shopDetail/shopDetail?&productId="+e[1]+"&uid="+i;break;case"dc":n="/pages/dianCan/pages/saomaDiancan/saomaDiancan?enterWay=wm&detail_id="+e[1]+"&uid="+i;break;case"hotel":n="/pages/hotel/pages/Hoteldetails/Hoteldetails?hotelid="+e[1]+"&uid="+i;break;case"service":n="/pages/service/pages/personal/personal?idx="+e[1]+"&uid="+i;break;case"appointment":n="/pages/appointment/pages/Reservation/Reservation?imd="+e[1]+"&uid="+i;break;case"bargain":n="/pages/bargain/pages/detail/detail?index=0&id="+e[1]+"&uid="+i;break;case"bag":n="/pages/bag/pages/launch/launch?index=0&id="+e[1]+"&uid="+i}return n}function seeImg(){var t=this.data.haiBaoList.original_url;common.seeBigImg(1,t,"")}function fangShiHide(){tkHide(this)}function tuiguangInfo(t,a){t.seeImg=seeImg,t.fangShiHide=fangShiHide,t.fangShishow=fangShishow;var e="/sales/?acid="+getApp().globalData.acid;util.httpRequest(e).then(function(e){t.setData({selasInfo:e,btnShow:!0,requestStatus:!0}),"extension"===a&&(wx.setNavigationBarTitle({title:e.title}),wx.pro.fromSync(function(a){if(e.drp.info){var i=WxParse.wxParse("article","html",e.drp.info,t,5);t.setData(i)}})),wx.hideLoading()})}function tkHide(t){var a=t.data.tgCenter;a.fangShi="hide",t.store({tgCenter:a,isScroll:!0})}function getProductDetial(t,a,e){var i="/product/"+a+"/";util.httpRequest(i).then(function(a){t.store({tgDataDetail:a}),a.has_bought||temp.calculatePrice(t,0,e),wx.hideLoading()})}function productList(t,a,e,i){var n="/sales/product/?offset="+a+"&limit="+t.state.limit+"&applyid="+e+"&typeid="+i+"&acid="+getApp().globalData.acid;util.httpRequest(n).then(function(e){var i=common.dataListHandle(t,e,t.data.tgDataList,a);t.store({tgDataList:i.list,listRequestStatus:!0,hasNext:i.hasNext})})}function config(t){util.httpRequest("/generalize/ganconfig/Config",{},"GET","v2").then(function(a){if("success"===a.result){t.setData({nav:a.data});var e=a.data;productList(t,0,e[0].applyId,0),t.state.applyId=e[0].applyId,t.state.typeId=0,common.updateTabOffsetTop(t)}else common.showClickModal(a.msg)})}function tgInfoSet(t){var a=t.state.option;a.hasOwnProperty("uid")&&wx.setStorageSync("inviteUid",a.uid),t.setData({numberValue:common.getStorage("userInfo").phone}),tuiguangInfo(t,"extension"),config(t)}function salesLockingData(t,a){var e="/api/ProToClient/LockTheAmount?limit="+t.state.limit+"&offset="+a;util.httpRequest(e,{},"GET","v2").then(function(e){if(wx.hideLoading(),"success"===e.result){var i=common.dataListHandle(t,e,t.data.lockList,a);t.setData({lockingNum:e.count,lockList:i.list,requestStatus:!0,hasNext:i.hasNext})}else common.showClickModal(e.msg)})}function salesFun(t,a){var e=a.currentTarget.dataset;if("applySubmit"===e.types)applySubmit(t,a);else if("shuoMingShow"===e.types){var i=t.data.tgCenter;i.shuoMing="show",t.store({tgCenter:i})}else if("shuoMingHide"===e.types){var n=t.data.tgCenter;n.shuoMing="hide",t.store({tgCenter:n})}else{if("fangShishow"===e.types){var s=a.currentTarget.dataset.index,o=t.data.tgDataList,d=t.data.tgCenter;return d.fangShi="show",o[s].hasOwnProperty("main_link")&&(t.state.mainLink=o[s].main_link),t.state.productId=o[s].id,t.store({tgCenter:d,isScroll:!1,tgDataDetail:o[s]}),wx.showLoading({title:"海报加载中...",mask:!0}),getInvite(t)}"onTapTag"===e.types&&onTapTag(t,a)}}function salesEvent(t){salesFun(this,t)}function shareEvent(t){t.url="/sales/qrcode/?acid="+getApp().globalData.acid+"&type=1",dataTemp.detailShare(this,t)}function onBackTop(){common.isscrollToPage(this)}function setSalesData(t){t.setData({interfaceName:"extensionCenter",contactStatus:!0,requestStatus:!1,listRequestStatus:!1,isFixed:!0,activeIndex:0,shareAlter:"hide",shareAlter1:"hide",detailgg:"hide",selasInfo:{},numberValue:"",nav:[],tgCenter:{shuoMing:"hide",fangShi:"hide"},lockingNum:0,index:0,tgCenterBtn:"hide",haiBaoList:{},tgDataList:[],tgDataDetail:{},tapIndex:0,CountdownVal:["发送验证码","发送验证码","发送验证码","发送验证码"],tankuang:["hide","hide","hide","hide"],CountdownTime:[60,60,60,60],onClick:[!0,!0,!0,!0],clearTimeout:!0,alterRequestStatus:!0}),t.state.limit=10,t.state.offset=0,t.state.hasmore=!0,t.state.option={},t.state.mainLink="";var a=t.state.opt;console.log(a);var e=decodeURIComponent(a.scene);console.log(e);var i={};if("undefined"!==e){i={uid:e.split("#")[0]}}else i=a;console.log(i),wx.hideShareMenu(),t.state.option=i,tgInfoSet(t),salesLockingData(t,0),common.commonFun(t),t.salesEvent=salesEvent,t.shareEvent=shareEvent,t.onBackTop=onBackTop}function applySubmit(t,a){wx.showLoading({title:"申请提交中...",mask:!0});var e={invite_uid:wx.getStorageSync("inviteUid"),wx_form_id:a.detail.formId},i="/sales/?acid="+getApp().globalData.acid;util.httpRequest(i,e,"POST").then(function(a){"success"===a.result?(tuiguangInfo(t,"extension"),common.showClickModal("申请成功")):(wx.hideLoading(),common.showClickModal(a.msg))})}function fangShishow(t){var a=this.data.tgCenter;a.fangShi="show",this.store({tgCenter:a}),wx.showLoading({title:"海报加载中...",mask:!0}),getInvite(this)}function onTapTag(t,a){var e=a.currentTarget.dataset.index;t.state.index=e;var i=t.data.nav;if(i[e].typeId.length>1)wx.showActionSheet({itemList:i[e].typeId,success:function(a){t.state.typeId=a.tapIndex,t.setData({activeIndex:e,tapIndex:a.tapIndex}),wx.showLoading({title:"加载中...",mask:!0}),t.state.applyId=i[e].applyId,productList(t,0,i[e].applyId,a.tapIndex)}});else{if(Number(t.data.activeIndex)===Number(e))return;wx.showLoading({title:"加载中...",mask:!0}),t.setData({activeIndex:e}),t.state.offset=0,t.state.applyId=i[e].applyId,t.state.typeId=0,productList(t,0,i[e].applyId,0)}t.data.isTabFixed&&wx.pageScrollTo({scrollTop:t.tabOffsetTop-50})}var common=getApp().globalData.commonFun,dataTemp=getApp().globalData.dataTempFun,util=getApp().globalData.utilFun,WxParse=require("../../../wxParse/wxParse.js"),temp=require("../../commonPage/zhuanlan/temp.js");module.exports={getInvite:getInvite,tgShare:tgShare,tkHide:tkHide,tuiguangInfo:tuiguangInfo,fangShishow:fangShishow,getProductDetial:getProductDetial,setSalesData:setSalesData,productList:productList,salesFun:salesFun,salesLockingData:salesLockingData};