"use strict";var common=getApp().globalData.commonFun,util=getApp().globalData.utilFun;Page({data:{interfaceName:"duihuanRecord",contactStatus:!0,requestStatus:!1,list:[]},state:{offset:0,limit:30,hasmore:!0,pageOnShow:!1,isOnReachBottom:!0,isonPullDownRefresh:!1},onLoad:function(t){wx.showLoading({title:"加载中...",mask:!0}),common.commonFun(this)},onShow:function(){this.getInteRecord(this.state.offset)},getInteRecord:function(t){var e="/point/record/?type=point&offset="+this.state.offset+"&limit="+this.state.limit,o=this;util.httpRequest(e).then(function(e){var s=common.dataListHandle(o,e,o.data.list,t);o.setData({list:s.list,requestStatus:!0,hasNext:s.hasNext}),wx.hideLoading()})},commentShop:function(t){var e=t.currentTarget.dataset.index,o=this.data.list;common.setStorage("commentImgUrl",o[e].pro_img.thumb_small_url),wx.navigateTo({url:"/pages/comment/commentShop/commentShop?id="+o[e].pro_id+"&type=pointShop"})},onPullDownRefresh:function(){this.state.isonPullDownRefresh=!0,wx.showLoading({title:"加载中...",mask:!0}),this.getInteRecord(0)},onReachBottom:function(){this.state.isonPullDownRefresh||this.state.isOnReachBottom&&this.state.hasmore&&(wx.showLoading({title:"加载中...",mask:!0}),this.state.offset+=this.state.limit,this.getInteRecord(this.state.offset),this.state.isOnReachBottom=!1)}});